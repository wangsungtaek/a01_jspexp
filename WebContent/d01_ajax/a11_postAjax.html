<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script type="text/javascript" src="/jspexp/a00_com/jquery-3.5.1.js"></script>
<script type="text/javascript">
/* 
# 요청값을 post방식으로 처리.
1. 요청 페이지와 요청값 호출을 분리 처리.
2. 추가 속성.
	open("post", "주소", true);
	sendRequestHeader("Content-Type, application/x-www-form-urlencoded")
	send("요청1=요청값1&요청2=요청값2")
 
*/
//
	var xhr = new XMLHttpRequest();
	$(document).ready(function(){
		
		$("[name=passwd]").keyup(function(){
			if(event.keyCode == 13) {
				ajaxFun();
			}
		});
		$("[name=cnt]").keyup(function(){
			if(event.keyCode == 13) {
				ajaxProdFun();
			}
		});
	});
	
	function ajaxFun() {
		var userid = $("[name=userid]").val();
		var passwd = $("[name=passwd]").val();
		var qstr = "userid="+userid+"&passwd="+passwd;
		xhr.open("post","z12_postData.jsp", true);
		xhr.setRequestHeader("Content-Type",
				"application/x-www-form-urlencoded");
		xhr.onreadystatechange = function(){
			if(xhr.readyState == 4 && xhr.status == 200){
				$("div").eq(0).html(xhr.responseText);
			}
		};
		xhr.send(qstr);
	}
	// ex) 물건등록(물건명, 가격, 갯수) post방식으로 전송해서
	//	하단에 json형식으로 데이터를 출력하게 하세요
	function ajaxProdFun() {
		var pname = $("[name=pname]").val();
		var price = $("[name=price]").val();
		var cnt = $("[name=cnt]").val();
		var qstr = "pname="+pname+"&price="+price+"&cnt="+cnt;
		xhr.open("post","z13_prodData.jsp", true);
		xhr.setRequestHeader("Content-Type",
				"application/x-www-form-urlencoded");
		xhr.onreadystatechange = function(){
			if(xhr.readyState == 4 && xhr.status == 200){
				// JSON.parse("문자열 json 데이터") : 객체로 변환
				
				var prod = JSON.parse(xhr.responseText);
				var show = "<h4>물건명 :"+prod.pname+"</h4>";
				show += "<h4>가격 :"+prod.price+"</h4>";
				show += "<h4>갯수 :"+prod.cnt+"</h4>";
				$("#prodDiv").html(show);
			}
		}
		xhr.send(qstr);
	}
	
</script>
</head>
<body>
	<h2>로그인</h2>
	<table>
		<tr><th>아이디</th><td><input type="text" name="userid"/></td></tr>
		<tr><th>패스워드</th><td><input type="password" name="passwd"/></td></tr>
	</table>
	<div></div>
	<h2>물건등록</h2>
	<table>
		<tr><th>물건명</th><td><input type="text" name="pname"/></td></tr>
		<tr><th>가격</th><td><input type="text" name="price"/></td></tr>
		<tr><th>갯수</th><td><input type="text" name="cnt"/></td></tr>
	</table>
	<div id="prodDiv"></div>
</body>
</html>